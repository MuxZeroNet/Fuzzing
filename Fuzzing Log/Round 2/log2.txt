List index type problem in `FileRequest.py`:


[01:00:03] FileServer Conn#17 127.0.0.1    [?] > Incoming connection...
[01:00:03] FileServer Conn#17 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: TypeError: list indices must be integers, not str in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 82 > FileRequest.py line 260
[01:00:03] FileServer Conn#17 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:00:03] FileServer Conn#18 127.0.0.1    [?] > Incoming connection...



Key Error in `FileRequest.py`:

[01:01:16] FileServer Conn#44 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#44 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: TypeError: unhashable type: 'dict' in Connection.py line 169 > fallback.py line 557 > fallback.py line 538
[01:01:16] FileServer Conn#44 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 1...
[01:01:16] FileServer Conn#45 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#45 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: KeyError: 'site' in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 82 > FileRequest.py line 260
[01:01:16] FileServer Conn#45 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:16] FileServer Conn#46 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#46 127.0.0.1    [v2] > Message should be a dict...
[01:01:16] FileServer Conn#46 127.0.0.1    [v2] > Message should be a dict...



`for item in <int>` in `FileRequest.py`:


[01:01:16] FileServer Conn#47 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#47 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: TypeError: argument of type 'int' is not iterable in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 58
[01:01:16] FileServer Conn#47 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...






[01:01:16] FileServer Conn#48 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#48 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 1...
[01:01:16] FileServer Conn#49 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#49 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: KeyError: 'site' in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 82 > FileRequest.py line 260
[01:01:16] FileServer Conn#49 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:16] FileServer Conn#50 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#50 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: TypeError: unhashable type: 'dict' in Connection.py line 169 > fallback.py line 557 > fallback.py line 538
[01:01:16] FileServer Conn#50 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 1...
[01:01:16] FileServer Conn#51 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#51 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: KeyError: 'site' in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 82 > FileRequest.py line 260
[01:01:16] FileServer Conn#51 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:16] FileServer Conn#52 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#52 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: KeyError: 'site' in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 82 > FileRequest.py line 260
[01:01:16] FileServer Conn#52 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:16] FileServer Conn#53 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#53 127.0.0.1    [v2] > Message should be a dict...


[01:01:16] FileServer Conn#54 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: error: [Errno 104] Connection reset by peer in Connection.py line 154 > _socket2.py line 274
[01:01:16] FileServer Conn#54 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:16] FileServer Conn#55 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#55 127.0.0.1    [v2] > Message should be a dict...
[01:01:16] FileServer Conn#55 127.0.0.1    [v2] > Message should be a dict...


[01:01:16] FileServer Conn#55 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: error: [Errno 104] Connection reset by peer in Connection.py line 154 > _socket2.py line 274
[01:01:16] FileServer Conn#55 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:16] FileServer Conn#56 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#56 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:16] FileServer Conn#57 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#57 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:16] FileServer Conn#58 127.0.0.1    [?] > Incoming connection...
[01:01:16] FileServer Conn#58 127.0.0.1    [v2] > Message should be a dict...
[01:01:16] FileServer Conn#58 127.0.0.1    [v2] > Message should be a dict...
[01:01:16] FileServer Conn#58 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:01:42] FileServer Conn#26 89.*.*.*     [v2] > [!!!] Unexpected Socket handler error: error: [Errno 104] Connection reset by peer in Connection.py line 154 > _sslgte279.py line 455 > _sslgte279.py line 310
[01:01:42] FileServer Conn#26 89.*.*.*     [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 3, buff: 0...
[01:01:44] FileServer Conn#27 164.*.*.*    [v2] > [!!!] Unexpected Socket handler error: error: [Errno 104] Connection reset by peer in Connection.py line 154 > _sslgte279.py line 455 > _sslgte279.py line 310
[01:01:44] FileServer Conn#27 164.*.*.*    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 3, buff: 0...
[01:01:45] FileServer Conn#31 217.*.*.*    [v2] > [!!!] Unexpected Socket handler error: error: [Errno 104] Connection reset by peer in Connection.py line 154 > _sslgte279.py line 455 > _sslgte279.py line 310






Here the fuzzer generated input data that cover different regions of code:
`AssertionError: Invalid length ip4 packed address`


[01:06:35] FileServer Conn#92 127.0.0.1    [v2] > Message should be a dict...
[01:06:35] FileServer Conn#92 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:06:35] FileServer Conn#93 127.0.0.1    [?] > Incoming connection...
[01:06:35] FileServer Conn#93 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: KeyError: 'site' in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 82 > FileRequest.py line 260
[01:06:35] FileServer Conn#93 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:06:35] FileServer Conn#94 127.0.0.1    [?] > Incoming connection...
[01:06:35] FileServer Conn#94 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 1...
[01:06:35] FileServer Conn#95 127.0.0.1    [?] > Incoming connection...
[01:06:35] FileServer Conn#95 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: AssertionError: Invalid length ip4 packed address: 1 in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 82 > FileRequest.py line 276 > helper.py line 97
[01:06:35] FileServer Conn#95 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 1, buff: 0...
[01:06:35] FileServer Conn#96 127.0.0.1    [?] > Incoming connection...
[01:06:35] FileServer Conn#96 127.0.0.1    [v2] > Message should be a dict...
[01:06:35] FileServer Conn#96 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: ValueError: ('%s exceeds max_array_len(%s)', 2908844902, 2147483647) in Connection.py line 169 > fallback.py line 557 > fallback.py line 538 > fallback.py line 538 > fallback.py line 498 > fallback.py line 481
[01:06:35] FileServer Conn#96 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:06:35] FileServer Conn#97 127.0.0.1    [?] > Incoming connection...
[01:06:35] FileServer Conn#97 127.0.0.1    [v2] > Message should be a dict...
[01:06:35] FileServer Conn#97 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 0...
[01:06:35] FileServer Conn#98 127.0.0.1    [?] > Incoming connection...
[01:06:35] FileServer Conn#98 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: ValueError: ('%s exceeds max_map_len(%s)', 2792514929, 2147483647) in Connection.py line 169 > fallback.py line 557 > fallback.py line 537 > fallback.py line 498 > fallback.py line 491
[01:06:35] FileServer Conn#98 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 0, buff: 1...
[01:06:35] FileServer Conn#99 127.0.0.1    [?] > Incoming connection...
[01:06:35] FileServer Conn#99 127.0.0.1    [v2] > [!!!] Unexpected Socket handler error: AssertionError: Invalid length ip4 packed address: 1 in Connection.py line 177 > Connection.py line 293 > FileServer.py line 43 > FileRequest.py line 82 > FileRequest.py line 276 > helper.py line 97
[01:06:35] FileServer Conn#99 127.0.0.1    [v2] > Closing connection: MessageLoop ended, waiting_requests: 0, sites: 1, buff: 0...
